<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.js"></script>
    <script>

//TODO: 
/*Gradient percentages
Line endpoints (ellipse and pointy fading endpoint)
Concentric circles opacity*/

//Desired: 
/*Line textures
Make arcs not circles*/

//Post production:
/*Frame border 
Text
Date*/


let topcolor, bottomcolor;

function setup() {
  //To resize canvas see https://p5js.org/reference/#/p5/resizeCanvas

  createCanvas(windowWidth, windowHeight);
  background(255,255,255);

  //TODO: This will be set in editor.html manually
  //Bottom color = Total tickets. Physical Audience (data from Eventbrite) 61 orders / 90 tickets 
  topcolor = color(86, 193, 255);
  bottomcolor = color(148, 23, 81);

  for (let y=0; y<height; y++){
    
    //n defines lerp (remap from ticket numbers and map inputs [])
    n = map(y,0,height, 0,1); 
    
    let newcolor = lerpColor(topcolor, bottomcolor, n);
    stroke(newcolor);
    line(0,y,width,y);
  }
    
    //center point
    // fill("#bb1a1a");
    // stroke('#bb1a1a');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 20)

}

function draw() {
  getData();
  async function getData() {
    const response = await fetch('/api');
    const data = await response.json();
    
    for (item of data){
      let color = `${item.color}`;
      let radius = `${item.radius}`;
      let lat = `${item.lat}`;
      let lon = `${item.lon}`;
      const pix = map.latLngToPixel(lat,lon);
      
      if(color){  
        noFill();
        stroke(color);
        strokeWeight(2);
        circle(windowWidth/2, windowHeight/2, radius);
        
        //TODO: Lines could have an ellipse at their endpoints
        line(windowWidth/2+10, windowHeight/2-7, pix.x, pix,y);
      }
    }
  }
  // noLoop();
}
    </script>
  </head>
  <body>
    <main>
    </main>
  </body>
</html>