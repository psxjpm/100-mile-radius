<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.js"></script>
    <script>

let topcolor, bottomcolor;
let canvasWidth, canvasHeight;

function setup() {
  canvasWidth = 1600;
  canvasHeight = 1200;
  createCanvas(canvasWidth, canvasHeight);
  rectMode(CENTER);
  noStroke();

  //TODO: center point follows the rules of 100 mile radius
    //center point
    // fill("#bb1a1a");
    // stroke('#bb1a1a');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 20)
}

function draw() {
  //TODO: This will be set in editor.html manually
  // The start gradient point is at x=0, y=0
  // The end gradient point is at x=0, y=0
  background(255);
 
  let gradient = drawingContext.createLinearGradient(0, 500, 0, 260);
  
  gradient.addColorStop(0,color(148, 23, 81));
  gradient.addColorStop(1,color(86, 193, 255));

  drawingContext.fillStyle = gradient;
  rect(width/2, height/2, 900, 900);

  getData();
  async function getData() {
    const response = await fetch('/api');
    const data = await response.json();
    
    for (item of data){
      let color = `${item.color}`;
      let radius = `${item.radius}`;
      let lat = `${item.lat}`;
      let lon = `${item.lon}`;
      let angle = radians(`${item.ang}`);

      let v = createVector();
      //radius is actually a diameter in p5
      v.set(radius/2, 0);
      v.rotate(angle+HALF_PI*3);

      let x1 = width/2;
      let y1 = height/2;

      let x2 = x1 + v.x;
      let y2 = y1 + v.y;

      if(radius < 1000){  
        noFill();
        stroke(color);
        strokeWeight(3);
        circle(x1, y1, radius);
        line(x1, y1, x2, y2);
      }
      else{
        noFill();
        stroke(color);
        strokeWeight(3);
        line(x1, y1, x2, y2);
      }
    }
  }
  noLoop();
}
    </script>
  </head>
  <body>
    <main>
    </main>
  </body>
</html>

<!-- //TODO: 
//Gradient percentages
//Line endpoints (ellipse and pointy fading endpoint)
//Concentric circles opacity

//Desired: 
//Make arcs not circles: https://p5js.org/reference/#/p5/arc