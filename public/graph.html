<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.js"></script>
    <script>

//TODO: 
/*Gradient percentages
Line endpoints (ellipse and pointy fading endpoint)
Concentric circles opacity*/

//Desired: 
/*Line textures
Make arcs not circles*/

//Post production:
/*Frame border 
Text
Date*/


let topcolor, bottomcolor;
// let fwriter;

// getData();
// async function getData() {
//   const response = await fetch('/api');
//   const data = await response.json();
//   writer.write(data);
//   writer.close()
// }

function preload(){
  table = loadTable("database.db", "json", "header");

}

function setup() {
  //To resize canvas see https://p5js.org/reference/#/p5/resizeCanvas
  // fwriter= createWriter('user.json');

  createCanvas(windowWidth, windowHeight);
  background(255,255,255);

  // Draw a square at location (30, 20) with a side size of 55 (??)

  //TODO: This will be set in editor.html manually
  //Bottom color = Total tickets. Physical Audience (data from Eventbrite) 61 orders / 90 tickets 
  topcolor = color(86, 193, 255);
  bottomcolor = color(148, 23, 81);

  for (let y=0; y<height; y++){
    
    //n defines lerp (remap from ticket numbers and map inputs [])
    n = map(y,0,height, 0,1); 
    
    let newcolor = lerpColor(topcolor, bottomcolor, n);
    stroke(newcolor);
    line(0,y,width,y);
    
    //center point
    // fill("#bb1a1a");
    // stroke('#bb1a1a');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 20)
    
    // //radii
    // noFill();
    // stroke('#88FA4E');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 80)
    
    // noFill();
    // stroke('#1DB100');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 140)
    
    // noFill();
    // stroke('#00FDFF');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 180)
    
    // noFill();
    // stroke('#0096FF');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 220)
    
    // noFill();
    // stroke('#9437FF');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 260)
    
    // noFill();
    // stroke('#942193');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 300)
    
    // noFill();
    // stroke('#FF40FF');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 340)
    
    // noFill();
    // stroke('#FF2F92');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 380)
    
    // noFill();
    // stroke('#FF9300');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 420)
    
    // noFill();
    // stroke('#FFFB00');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 460)
    
    // noFill();
    // stroke('#522E6E');
    // strokeWeight(2);
    // circle(windowWidth/2, windowHeight/2, 500)
    
    //LINES
    //TODO: Lines should have an ellipse at their endpoints

    //x1, y1 = 38, 31; x2, y2 = 300, 20;
    // Use line() function to draw line
    stroke('#FFFB00');
    strokeWeight(2);
    line(windowWidth/2+10, windowHeight/2-7, 785, 195);
    
    
    fill("#bb1a1a");
    stroke('#bb1a1a');
    strokeWeight(2);
    line(windowWidth/2-7, windowHeight/2-7, 185, 195);
    
  }
}

function draw() {
  //TODO: receive coordinates and plot here
  // noFill();
  // if (colour === '#522E6E'){
  //   stroke('#522E6E');
  //   strokeWeight(2);
  //   circle(windowWidth/2, windowHeight/2, 500)
  // }

  let numRows = table.getRowCount();

// Use a for loop to iterate through each row in the table
for (let i = 0; i < numRows; i++) {
  // Get the values from the columns in the row
  let x = table.getNum(i, "x");
  let y = table.getNum(i, "y");
  let r = table.getNum(i, "r");

  // Use the `ellipse` function to draw a circle with the values from the table
  ellipse(x, y, r, r)}
}
    </script>
  </head>
  <body>
    <main>
    </main>
  </body>
</html>